<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0" />
  <title>FRC Scouting Web App</title>
  <style>
    :root {
      --bg: #121212;
      --text: #f0f0f0;
      --accent: #834980;
      --green: #28a745;
      --red: #cc3333;
      --cell: #1e1e1e;
      --button-bg: #333;
      --turquoise: #5CB9A4;
      --black: #000000;
    }

    body {
      background-color: var(--bg);
      color: var(--text);
      font-family: sans-serif;
      margin: 0;
      padding: 0;
    }

    .tab-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #1a1a1a;
      padding: 0.75rem 1rem;
      font-size: 1.25rem;
    }

    .nav-button {
      display: flex;
      align-items: center;
      gap: 6px;
      background: none;
      border: none;
      color: white;
      font-size: 1rem;
      cursor: pointer;
      touch-action: manipulation;
    }

    .hidden {
      visibility: hidden;
    }

    .tab-title {
      text-align: center;
      flex-grow: 1;
      font-weight: bold;
    }

    .tab-content {
      padding: 1rem;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background-color: var(--cell);
      border-radius: 12px;
      overflow: hidden;
      margin-top: 20px;
    }

    th, td {
      padding: 12px;
      text-align: center;
      border: 1px solid #333;
    }

    th:first-child,
    td:first-child {
      max-width: 100px;
      width: 100px;
      word-break: break-word;
    }

    th {
      background-color: #222;
    }

    td.level-label {
      background-color: #181818;
      font-weight: bold;
    }

    td.top-left {
      font-weight: bold;
      color: white;
    }

    .first-top-left {
      background-color: var(--accent) !important;
    }

    .second-top-left {
      background-color: var(--turquoise) !important;
    }

    .third-top-left {
      background-color: var(--black) !important;
    }

    .counter {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
    }

    .plus {
      border: none;
      color: white;
      border-radius: 8px;
      padding: 10px;
      font-size: 1rem;
      cursor: pointer;
      touch-action: manipulation;
    }

    .plus.pass {
      background-color: var(--green);
    }

    .plus.fail {
      background-color: var(--red);
    }

    .coral-algae {
      background-color: var(--red) !important;
    }

    .number {
      min-width: 30px;
      font-size: 1.2rem;
    }

    .actions {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: nowrap;
    }

    .actions button {
      padding: 10px 18px;
      font-size: 1rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      background-color: var(--button-bg);
      color: white;
      min-width: 100px;
      touch-action: manipulation;
    }

    @media (max-width: 600px) {
      th, td {
        padding: 10px;
        font-size: 0.9rem;
      }

      .plus {
        padding: 8px;
        font-size: 0.9rem;
      }

      .number {
        font-size: 1rem;
      }

      .actions {
        gap: 10px;
      }

      .actions button {
        font-size: 0.9rem;
        padding: 8px 12px;
        min-width: 80px;
      }

      .nav-button {
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>

  <div class="tab-nav">
    <button id="leftArrow" class="nav-button" onclick="prevTab()"></button>
    <div class="tab-title" id="tab-title">TeleOP</div>
    <button id="rightArrow" class="nav-button" onclick="nextTab()"></button>
  </div>

  <div class="tab-content" id="tab-content"></div>

  <script>
    const tabs = ['Setup', 'Pre-Match', 'Auton', 'TeleOP', 'Endgame'];
    let currentTab = 3;

    const tabTitle = document.getElementById("tab-title");
    const tabContent = document.getElementById("tab-content");
    const leftArrow = document.getElementById("leftArrow");
    const rightArrow = document.getElementById("rightArrow");

    const history = [];
    const redoStack = [];

    function renderTab(index) {
      currentTab = index;
      tabTitle.textContent = tabs[index];
      redoStack.length = 0;
      history.length = 0;

      // Arrow display logic
      leftArrow.classList.toggle('hidden', index === 0);
      rightArrow.classList.toggle('hidden', index === tabs.length - 1);
      leftArrow.innerHTML = index > 0 ? `&#8592; ${tabs[index - 1]}` : '';
      rightArrow.innerHTML = index < tabs.length - 1 ? `${tabs[index + 1]} &#8594;` : '';

      if (tabs[index] !== 'TeleOP') {
        tabContent.innerHTML = `<h2>${tabs[index]}</h2>`;
        return;
      }

      tabContent.innerHTML = `
        <table>
          <thead>
            <tr>
              <td class="top-left first-top-left">Level</td>
              <th>Fail</th>
              <th>Pass</th>
            </tr>
          </thead>
          <tbody>
            ${['L4', 'L3', 'L2', 'L1'].map(level => `
              <tr>
                <td class="level-label">${level}</td>
                <td><div class="counter" data-type="fail"><div class="number">0</div><button class="plus fail" onclick="increment(this)">+</button></div></td>
                <td><div class="counter" data-type="pass"><div class="number">0</div><button class="plus pass" onclick="increment(this)">+</button></div></td>
              </tr>
            `).join('')}
          </tbody>
        </table>

        <table>
          <thead>
            <tr>
              <td class="top-left second-top-left">Location</td>
              <th>Fail</th>
              <th>Pass</th>
            </tr>
          </thead>
          <tbody>
            ${['Barge', 'Processor'].map(loc => `
              <tr>
                <td class="level-label">${loc}</td>
                <td><div class="counter" data-type="fail"><div class="number">0</div><button class="plus fail" onclick="increment(this)">+</button></div></td>
                <td><div class="counter" data-type="pass"><div class="number">0</div><button class="plus pass" onclick="increment(this)">+</button></div></td>
              </tr>
            `).join('')}
          </tbody>
        </table>

        <table>
          <thead>
            <tr>
              <td class="top-left third-top-left">Item</td>
              <th>Count</th>
            </tr>
          </thead>
          <tbody>
            ${['Coral', 'Algae'].map(item => `
              <tr>
                <td class="level-label">${item}</td>
                <td><div class="counter" data-type="pass"><div class="number">0</div><button class="plus coral-algae" onclick="increment(this)">+</button></div></td>
              </tr>
            `).join('')}
          </tbody>
        </table>

        <div class="actions">
          <button onclick="undo()">Undo</button>
          <button onclick="redo()">Redo</button>
        </div>
      `;

      preventDoubleTap();
    }

    function prevTab() {
      if (currentTab > 0) renderTab(currentTab - 1);
    }

    function nextTab() {
      if (currentTab < tabs.length - 1) renderTab(currentTab + 1);
    }

    function increment(button) {
      const counter = button.closest(".counter");
      const number = counter.querySelector(".number");
      const value = parseInt(number.textContent);
      number.textContent = value + 1;

      const type = counter.getAttribute("data-type");
      const row = button.closest("tr") || counter;
      history.push({ row, type });
      redoStack.length = 0;
    }

    function undo() {
      if (history.length === 0) return;
      const last = history.pop();
      const container = last.row.querySelector(`[data-type="${last.type}"] .number`);
      const val = parseInt(container.textContent);
      if (val > 0) container.textContent = val - 1;
      redoStack.push(last);
    }

    function redo() {
      if (redoStack.length === 0) return;
      const action = redoStack.pop();
      const container = action.row.querySelector(`[data-type="${action.type}"] .number`);
      container.textContent = parseInt(container.textContent) + 1;
      history.push(action);
    }

    function preventDoubleTap() {
      document.querySelectorAll("button").forEach(button => {
        let lastTap = 0;
        button.addEventListener("touchend", e => {
          const currentTime = new Date().getTime();
          const tapLength = currentTime - lastTap;
          if (tapLength < 300 && tapLength > 0) {
            e.preventDefault();
          }
          lastTap = currentTime;
        });
      });
    }

    // Initial render
    renderTab(currentTab);
  </script>
</body>
</html>
